<!DOCTYPE html>
<html>
<head>
  <title>Screen Viewer</title>
</head>
<body>
  <h1>ðŸ“º Remote Screen Viewer</h1>
  <video id="video" autoplay playsinline style="width: 90%; border: 2px solid black;"></video>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script>
    const socket = io("http://localhost:3000");
    const pc = new RTCPeerConnection();

    const video = document.getElementById("video");
    pc.ontrack = event => {
      video.srcObject = event.streams[0];
    };

    pc.onicecandidate = event => {
      if (event.candidate) socket.emit("ice", event.candidate.toJSON());
    };

    socket.emit("viewer");

    socket.on("offer", async offer => {
      await pc.setRemoteDescription(offer);
      const answer = await pc.createAnswer();
      await pc.setLocalDescription(answer);
      socket.emit("answer", {
        sdp: pc.localDescription.sdp,
        type: pc.localDescription.type
      });
    });

    socket.on("ice", async candidate => {
      await pc.addIceCandidate(candidate);
    });
  </script>
</body>
</html>
